@model List<RoomViewModel>

@{
    ViewData["Title"] = "Pokoje";
}

@foreach (var room in Model)
{
    <div>
        <h3>@room.Name</h3>
        <p>Pojemność: @room.Capacity</p>
        <p>Cena za noc (PLN): @room.PricePerNight</p>

        <!-- Przycisk do przeliczenia ceny na USD -->
        <button onclick="getPriceInUsd(@room.PricePerNight)">Przelicz na USD</button>

        <!-- Miejsce na wynik -->
        <p class="result"></p> <!-- Zaktualizujemy wszystkie wyniki w tym samym elemencie -->
    </div>
}

<script>
    function getPriceInUsd(priceInPLN) {
        console.log("Cena w PLN:", priceInPLN);

        // Wysyłanie zapytania AJAX do kontrolera
        fetch(`/Room/GetPriceInUsd?priceInPLN=${priceInPLN}`)
            .then(response => response.json())
            .then(data => {
                const resultElements = document.querySelectorAll('.result'); // Pobranie wszystkich wyników

                if (data.success) {
                    console.log("Cena w USD:", data.priceInUsd);
                    resultElements.forEach(element => {
                        element.textContent = `Cena w USD: ${data.priceInUsd}`; // Zaktualizowanie tekstu w elemencie
                    });
                } else {
                    console.log("Błąd:", data.message);
                    resultElements.forEach(element => {
                        element.textContent = `Błąd: ${data.message}`; // Zaktualizowanie tekstu o błędzie
                    });
                }
            })
            .catch(error => {
                console.error("Błąd:", error);
                alert("Wystąpił błąd podczas pobierania ceny.");
            });
    }
</script>